{"version":3,"names":["mobx_1","require","constants_1","helper_1","exports","OtherPlayers","store","makeAutoObservable","players","online","getOtherProf","_getOtherProf","_asyncToGenerator2","default","_ref","snapshot","otherData","Promise","all","docs","map","_ref2","a","exists","data","isOnline","getFireBaseRef","owner","once","then","_ref3","snapshotOnline","val","_x3","apply","arguments","catch","err","captureException","result","email","plan","firstName","lastName","avatar","getIMG","status","_x2","filter","undefined","getOnlineProf","_x","_getOnlineProf","length"],"sources":["/Users/playra/leela/src/store/OtherPlayers.ts"],"sourcesContent":["import { FirebaseFirestoreTypes } from '@react-native-firebase/firestore'\nimport { makeAutoObservable } from 'mobx'\n\nimport { captureException } from '../constants'\nimport { getFireBaseRef, getIMG } from '../screens/helper'\nimport { OtherUsersT, UserT } from '../types'\n\ninterface storeI {\n  players: OtherUsersT[]\n  online: OtherUsersT[]\n}\n\ninterface GetOtherI {\n  snapshot?: FirebaseFirestoreTypes.QuerySnapshot<FirebaseFirestoreTypes.DocumentData>\n}\n\nexport const OtherPlayers = {\n  store: makeAutoObservable<storeI>({\n    players: [],\n    online: []\n  }),\n  getOtherProf: async ({ snapshot }: GetOtherI) => {\n    if (snapshot) {\n      const otherData: any = await Promise.all(\n        snapshot.docs.map(async (a) => {\n          if (a.exists) {\n            const data: UserT = a.data() as UserT\n            let isOnline = false\n            await getFireBaseRef(`/online/${data.owner}`)\n              .once('value')\n              .then(async (snapshotOnline) => {\n                isOnline = snapshotOnline.val()\n              })\n              .catch((err) => captureException(err, 'getOtherProf'))\n            const result: OtherUsersT = {\n              email: data.email,\n              plan: data.plan,\n              firstName: data.firstName,\n              lastName: data.lastName,\n              avatar: data.avatar ? await getIMG(data.avatar) : '',\n              owner: data.owner,\n              status: data.status,\n              isOnline\n            }\n\n            return result\n          }\n        })\n      )\n      if (otherData) {\n        OtherPlayers.store.players = otherData.filter(\n          (a: any) => a !== undefined\n        )\n      }\n      OtherPlayers.getOnlineProf()\n    }\n  },\n  getOnlineProf: async () => {\n    if (OtherPlayers.store.players.length > 0) {\n      OtherPlayers.store.online = OtherPlayers.store.players.filter(\n        (a) => a.isOnline\n      )\n    }\n  }\n}\n"],"mappings":";;;;;;;;AACA,IAAAA,MAAA,GAAAC,OAAA;AAEA,IAAAC,WAAA,GAAAD,OAAA;AACA,IAAAE,QAAA,GAAAF,OAAA;AAYaG,OAAA,CAAAC,YAAY,GAAG;EAC1BC,KAAK,EAAE,IAAAN,MAAA,CAAAO,kBAAkB,EAAS;IAChCC,OAAO,EAAE,EAAE;IACXC,MAAM,EAAE;GACT,CAAC;EACFC,YAAY;IAAA,IAAAC,aAAA,OAAAC,kBAAA,CAAAC,OAAA,EAAE,WAAAC,IAAA,EAAkC;MAAA,IAAzBC,QAAQ,GAAAD,IAAA,CAARC,QAAQ;MAC7B,IAAIA,QAAQ,EAAE;QACZ,IAAMC,SAAS,SAAcC,OAAO,CAACC,GAAG,CACtCH,QAAQ,CAACI,IAAI,CAACC,GAAG;UAAA,IAAAC,KAAA,OAAAT,kBAAA,CAAAC,OAAA,EAAC,WAAOS,CAAC,EAAI;YAC5B,IAAIA,CAAC,CAACC,MAAM,EAAE;cACZ,IAAMC,IAAI,GAAUF,CAAC,CAACE,IAAI,EAAW;cACrC,IAAIC,QAAQ,GAAG,KAAK;cACpB,MAAM,IAAAtB,QAAA,CAAAuB,cAAc,eAAYF,IAAI,CAACG,KAAO,CAAC,CAC1CC,IAAI,CAAC,OAAO,CAAC,CACbC,IAAI;gBAAA,IAAAC,KAAA,OAAAlB,kBAAA,CAAAC,OAAA,EAAC,WAAOkB,cAAc,EAAI;kBAC7BN,QAAQ,GAAGM,cAAc,CAACC,GAAG,EAAE;gBACjC,CAAC;gBAAA,iBAAAC,GAAA;kBAAA,OAAAH,KAAA,CAAAI,KAAA,OAAAC,SAAA;gBAAA;cAAA,IAAC,CACDC,KAAK,CAAC,UAACC,GAAG;gBAAA,OAAK,IAAAnC,WAAA,CAAAoC,gBAAgB,EAACD,GAAG,EAAE,cAAc,CAAC;cAAA,EAAC;cACxD,IAAME,MAAM,GAAgB;gBAC1BC,KAAK,EAAEhB,IAAI,CAACgB,KAAK;gBACjBC,IAAI,EAAEjB,IAAI,CAACiB,IAAI;gBACfC,SAAS,EAAElB,IAAI,CAACkB,SAAS;gBACzBC,QAAQ,EAAEnB,IAAI,CAACmB,QAAQ;gBACvBC,MAAM,EAAEpB,IAAI,CAACoB,MAAM,SAAS,IAAAzC,QAAA,CAAA0C,MAAM,EAACrB,IAAI,CAACoB,MAAM,CAAC,GAAG,EAAE;gBACpDjB,KAAK,EAAEH,IAAI,CAACG,KAAK;gBACjBmB,MAAM,EAAEtB,IAAI,CAACsB,MAAM;gBACnBrB,QAAQ,EAARA;eACD;cAED,OAAOc,MAAM;;UAEjB,CAAC;UAAA,iBAAAQ,GAAA;YAAA,OAAA1B,KAAA,CAAAa,KAAA,OAAAC,SAAA;UAAA;QAAA,IAAC,CACH;QACD,IAAInB,SAAS,EAAE;UACbZ,OAAA,CAAAC,YAAY,CAACC,KAAK,CAACE,OAAO,GAAGQ,SAAS,CAACgC,MAAM,CAC3C,UAAC1B,CAAM;YAAA,OAAKA,CAAC,KAAK2B,SAAS;UAAA,EAC5B;;QAEH7C,OAAA,CAAAC,YAAY,CAAC6C,aAAa,EAAE;;IAEhC,CAAC;IAAA,SAAAxC,aAAAyC,EAAA;MAAA,OAAAxC,aAAA,CAAAuB,KAAA,OAAAC,SAAA;IAAA;IAAA,OAAAzB,YAAA;EAAA;EACDwC,aAAa;IAAA,IAAAE,cAAA,OAAAxC,kBAAA,CAAAC,OAAA,EAAE,aAAW;MACxB,IAAIT,OAAA,CAAAC,YAAY,CAACC,KAAK,CAACE,OAAO,CAAC6C,MAAM,GAAG,CAAC,EAAE;QACzCjD,OAAA,CAAAC,YAAY,CAACC,KAAK,CAACG,MAAM,GAAGL,OAAA,CAAAC,YAAY,CAACC,KAAK,CAACE,OAAO,CAACwC,MAAM,CAC3D,UAAC1B,CAAC;UAAA,OAAKA,CAAC,CAACG,QAAQ;QAAA,EAClB;;IAEL,CAAC;IAAA,SAAAyB,cAAA;MAAA,OAAAE,cAAA,CAAAlB,KAAA,OAAAC,SAAA;IAAA;IAAA,OAAAe,aAAA;EAAA;CACF"}